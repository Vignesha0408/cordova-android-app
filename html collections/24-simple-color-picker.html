<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simple Color Picker</title>
  <style>
    :root{ --bg:#0b1022; --panel:#0f172a; --text:#e5e7eb; --muted:#94a3b8; --accent:#38bdf8 }
    *{ box-sizing:border-box }
    body{ margin:0; min-height:100vh; display:grid; place-items:center; background:radial-gradient(900px 600px at 15% 0%, #111827, #0b1022 60%, #050814); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial }
    .app{ width:min(720px,92vw); background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:18px; box-shadow:0 10px 40px rgba(0,0,0,.5) }
    h1{ margin:0 0 8px 0; font-size:28px }
    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px }
    .panel{ background:var(--panel); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:14px }
    .swatch{ height:120px; border-radius:12px; border:1px solid rgba(255,255,255,.12) }
    .row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center }
    .input{ width:100%; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); color:var(--text) }
    .palette{ display:grid; grid-template-columns: repeat(auto-fill, 40px); gap:8px; margin-top:10px }
    .cell{ width:40px; height:40px; border-radius:8px; border:1px solid rgba(255,255,255,.12); cursor:pointer }
  </style>
</head>
<body>
  <div class="app">
    <h1>Simple Color Picker</h1>

    <div class="grid">
      <div class="panel">
        <div id="swatch" class="swatch"></div>
        <div class="row" style="margin-top:10px">
          <input id="hex" class="input" placeholder="#1e293b" />
          <button id="copyHex" class="input" style="max-width:120px">Copy</button>
        </div>
        <div class="row">
          <input id="rgb" class="input" placeholder="rgb(30,41,59)" />
          <input id="hsl" class="input" placeholder="hsl(210,30%,17%)" />
        </div>
      </div>
      <div class="panel">
        <div class="row">
          <input id="picker" type="color" class="input" value="#1e293b" />
          <button id="save" class="input" style="max-width:140px">Save color</button>
          <button id="clear" class="input" style="max-width:140px">Clear</button>
        </div>
        <div id="palette" class="palette"></div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const swatch = document.getElementById('swatch');
      const hex = document.getElementById('hex');
      const rgb = document.getElementById('rgb');
      const hsl = document.getElementById('hsl');
      const picker = document.getElementById('picker');
      const copyHex = document.getElementById('copyHex');
      const saveBtn = document.getElementById('save');
      const clearBtn = document.getElementById('clear');
      const paletteEl = document.getElementById('palette');
      const storageKey = 'color-palette-v1';
      let palette = load();

      function load(){ try{ return JSON.parse(localStorage.getItem(storageKey))||[] }catch(_){ return [] } }
      function save(){ localStorage.setItem(storageKey, JSON.stringify(palette)); }
      function clampByte(n){ n=Math.round(Number(n)); return Math.min(255, Math.max(0, Number.isNaN(n)?0:n)); }

      function setColor(c){ swatch.style.background = c; picker.value = toHex(c); hex.value = toHex(c); rgb.value = toRGB(c); hsl.value = toHSL(c); }
      function toHex(c){ const ctx=document.createElement('canvas').getContext('2d'); ctx.fillStyle=c; const comp = ctx.fillStyle; // resolves named/short
        if(/^#/.test(comp)) return comp; return '#000000'; }
      function toRGB(c){ const d=document.createElement('div'); d.style.color=c; document.body.appendChild(d); const cs=getComputedStyle(d).color; d.remove(); return cs; }
      function toHSL(c){ const d=document.createElement('div'); d.style.color=c; document.body.appendChild(d); const cs=getComputedStyle(d).color; d.remove(); const m=cs.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/); if(!m) return 'hsl(0,0%,0%)'; const r=+m[1]/255,g=+m[2]/255,b=+m[3]/255; const max=Math.max(r,g,b), min=Math.min(r,g,b); let h,s,l=(max+min)/2; if(max===min){ h=s=0; } else { const d=max-min; s=l>0.5?d/(2-max-min):d/(max+min); switch(max){ case r: h=(g-b)/d + (g<b?6:0); break; case g: h=(b-r)/d + 2; break; default: h=(r-g)/d + 4; } h/=6; } return `hsl(${Math.round(h*360)}, ${Math.round(s*100)}%, ${Math.round(l*100)}%)`; }

      picker.addEventListener('input', ()=> setColor(picker.value));
      hex.addEventListener('change', ()=> setColor(hex.value));
      rgb.addEventListener('change', ()=> setColor(rgb.value));
      hsl.addEventListener('change', ()=> setColor(hsl.value));
      copyHex.addEventListener('click', async ()=>{ try{ await navigator.clipboard.writeText(hex.value); copyHex.textContent='Copied'; setTimeout(()=>copyHex.textContent='Copy',1000); }catch(_){ } });

      function render(){ paletteEl.innerHTML=''; for(const c of palette){ const cell=document.createElement('div'); cell.className='cell'; cell.style.background=c; cell.title=c; cell.addEventListener('click', ()=> setColor(c)); paletteEl.appendChild(cell); } }
      saveBtn.addEventListener('click', ()=>{ palette.unshift(hex.value); palette = [...new Set(palette)].slice(0,100); save(); render(); });
      clearBtn.addEventListener('click', ()=>{ palette=[]; save(); render(); });

      setColor(picker.value); render();
    })();
  </script>
</body>
</html>
