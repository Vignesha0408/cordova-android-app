<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QR Code Generator</title>
  <style>
    :root{ --bg:#07101f; --panel:#0f172a; --muted:#94a3b8; --text:#e5e7eb; --accent:#38bdf8 }
    *{ box-sizing:border-box }
    body{ margin:0; min-height:100vh; display:grid; place-items:center; background:radial-gradient(800px 500px at 10% 0%, #0c1733, #07101f 60%, #050814); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial }
    .app{ width:min(500px,94vw); background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:24px; box-shadow:0 10px 40px rgba(0,0,0,.5) }
    h1{ margin:0 0 20px; text-align:center; color:var(--accent) }
    .input-group{ margin-bottom:20px }
    .input{ width:100%; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); color:var(--text); font-size:16px; margin-bottom:15px }
    .input:focus{ outline:none; border-color:var(--accent); box-shadow:0 0 0 2px rgba(56,189,248,.2) }
    .btn{ padding:12px 24px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:var(--accent); color:#000; cursor:pointer; font-weight:600; font-size:16px; margin:5px; transition:all 0.3s ease }
    .btn:hover{ background:#0ea5e9; transform:translateY(-2px) }
    .btn:disabled{ background:var(--muted); cursor:not-allowed; transform:none }
    .preview{ display:grid; place-items:center; background:#fff; border-radius:12px; padding:20px; margin:20px 0; min-height:200px }
    .preview canvas{ max-width:100%; height:auto; border-radius:8px }
    .preview .placeholder{ color:var(--muted); font-size:18px }
    .controls{ display:flex; justify-content:center; gap:10px; flex-wrap:wrap }
    .error{ color:#ef4444; background:rgba(239,68,68,.1); padding:10px; border-radius:8px; margin:10px 0; border:1px solid rgba(239,68,68,.2) }
  </style>
</head>
<body>
  <div class="app">
    <h1>QR Code Generator</h1>

    <div class="input-group">
      <input id="textInput" class="input" placeholder="Enter text or URL to generate QR code..." />
      </div>
    
    <div class="controls">
      <button id="previewBtn" class="btn">Preview QR Code</button>
      <button id="downloadBtn" class="btn" disabled>Download PNG</button>
    </div>

    <div id="preview" class="preview">
      <div class="placeholder">Enter text above and click Preview</div>
    </div>
  </div>

  <script>
    (function(){
      const textInput = document.getElementById('textInput');
      const previewBtn = document.getElementById('previewBtn');
      const downloadBtn = document.getElementById('downloadBtn');
      const preview = document.getElementById('preview');
      
      let currentQRCode = null;

      // Simple QR Code generator using a basic algorithm
      function generateQRCode(text) {
        try {
          // Create a simple QR-like pattern (simplified version)
          const size = 25; // Fixed size for simplicity
          const matrix = Array(size).fill().map(() => Array(size).fill(0));
          
          // Add corner finder patterns
          function addFinderPattern(x, y) {
            for(let i = 0; i < 7; i++) {
              for(let j = 0; j < 7; j++) {
                if(x + i < size && y + j < size) {
                  const isBorder = i === 0 || i === 6 || j === 0 || j === 6;
                  const isInner = i >= 2 && i <= 4 && j >= 2 && j <= 4;
                  matrix[x + i][y + j] = isBorder || isInner ? 1 : 0;
                }
              }
            }
          }
          
          // Add finder patterns at corners
          addFinderPattern(0, 0);
          addFinderPattern(0, size - 7);
          addFinderPattern(size - 7, 0);
          
          // Add timing patterns
          for(let i = 8; i < size - 8; i++) {
            matrix[6][i] = i % 2;
            matrix[i][6] = i % 2;
          }
          
          // Generate data pattern based on text
          const textBytes = new TextEncoder().encode(text);
          let dataIndex = 0;
          
          for(let row = 0; row < size; row++) {
            for(let col = 0; col < size; col++) {
              // Skip reserved areas
              if(matrix[row][col] !== 0) continue;
              
              // Create pattern based on text data
              const byteIndex = dataIndex % textBytes.length;
              const bitIndex = Math.floor(dataIndex / textBytes.length) % 8;
              const bit = (textBytes[byteIndex] >> (7 - bitIndex)) & 1;
              
              matrix[row][col] = bit;
              dataIndex++;
            }
          }
          
          return matrix;
        } catch(e) {
          throw new Error('Failed to generate QR code: ' + e.message);
        }
      }

      function renderQRCode(matrix) {
        const canvas = document.createElement('canvas');
        const size = 200; // Output size
        const cellSize = size / matrix.length;
        
        canvas.width = size;
        canvas.height = size;
        
        const ctx = canvas.getContext('2d');
        
        // White background
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, size, size);
        
        // Black squares
        ctx.fillStyle = '#000000';
        for(let row = 0; row < matrix.length; row++) {
          for(let col = 0; col < matrix[row].length; col++) {
            if(matrix[row][col] === 1) {
              ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
            }
          }
        }
        
        return canvas;
      }

      function showError(message) {
        preview.innerHTML = `<div class="error">${message}</div>`;
        downloadBtn.disabled = true;
        currentQRCode = null;
      }

      function previewQRCode() {
        const text = textInput.value.trim();
        
        if(!text) {
          showError('Please enter some text to generate QR code');
          return;
        }
        
        if(text.length > 100) {
          showError('Text is too long. Please keep it under 100 characters.');
          return;
        }
        
        try {
          const matrix = generateQRCode(text);
          const canvas = renderQRCode(matrix);
          
          preview.innerHTML = '';
          preview.appendChild(canvas);
          
          currentQRCode = canvas;
          downloadBtn.disabled = false;
        } catch(e) {
          showError(e.message);
        }
      }

      function downloadPNG() {
        if(!currentQRCode) {
          alert('Please generate a QR code first');
          return;
        }
        
        const link = document.createElement('a');
        link.download = 'qrcode.png';
        link.href = currentQRCode.toDataURL('image/png');
        link.click();
      }

      // Event listeners
      previewBtn.addEventListener('click', previewQRCode);
      downloadBtn.addEventListener('click', downloadPNG);
      
      // Generate QR code on Enter key
      textInput.addEventListener('keypress', function(e) {
        if(e.key === 'Enter') {
          previewQRCode();
        }
      });
      
      // Clear preview when text changes
      textInput.addEventListener('input', function() {
        if(currentQRCode) {
          preview.innerHTML = '<div class="placeholder">Click Preview to generate new QR code</div>';
          downloadBtn.disabled = true;
          currentQRCode = null;
        }
      });
    })();
  </script>
</body>
</html>
