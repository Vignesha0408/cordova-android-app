<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simple Paint</title>
  <style>
    :root{ --bg:#0b1022; --panel:#0f172a; --text:#e5e7eb; --muted:#94a3b8; --accent:#38bdf8 }
    *{ box-sizing:border-box }
    body{ margin:0; min-height:100vh; display:grid; grid-template-rows:auto 1fr; background:radial-gradient(900px 600px at 15% 0%, #111827, #0b1022 60%, #050814); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial }
    .toolbar{ display:flex; gap:8px; flex-wrap:wrap; padding:12px; background:rgba(255,255,255,.03); border-bottom:1px solid rgba(255,255,255,.08) }
    .btn{ padding:10px 14px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:var(--text); cursor:pointer; font-weight:600 }
    .input{ padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); color:var(--text) }
    .stage{ display:grid; place-items:center; padding:12px }
    canvas{ background:#fff; border-radius:10px; max-width:95vw; box-shadow:0 8px 40px rgba(0,0,0,.35) }
  </style>
</head>
<body>
  <div class="toolbar">
    <button id="toolBrush" class="btn">Brush</button>
    <button id="toolRect" class="btn">Rect</button>
    <button id="toolCircle" class="btn">Circle</button>
    <div>Color <input id="color" type="color" class="input" value="#1e293b" /></div>
    <div>Size <input id="size" type="range" class="input" min="1" max="40" value="6" /></div>
    <button id="undo" class="btn">Undo</button>
    <button id="redo" class="btn">Redo</button>
    <button id="clear" class="btn">Clear</button>
    <button id="save" class="btn">Save PNG</button>
  </div>
  <div class="stage">
    <canvas id="canvas" width="1200" height="800"></canvas>
  </div>

  <script>
    (function(){
      const canvas=document.getElementById('canvas'); const ctx=canvas.getContext('2d');
      const colorEl=document.getElementById('color'); const sizeEl=document.getElementById('size');
      let tool='brush', color=colorEl.value, size=Number(sizeEl.value); let drawing=false; let start=null; const undoStack=[], redoStack=[];
      function push(){ undoStack.push(canvas.toDataURL()); if(undoStack.length>50) undoStack.shift(); redoStack.length=0; }
      function pos(e){ const r=canvas.getBoundingClientRect(); const x=(e.touches?e.touches[0].clientX:e.clientX)-r.left; const y=(e.touches?e.touches[0].clientY:e.clientY)-r.top; return {x,y}; }
      function line(a,b){ ctx.lineCap='round'; ctx.lineJoin='round'; ctx.strokeStyle=color; ctx.lineWidth=size; ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke(); }
      function drawPreview(a,b){ ctx.putImageData(snapshot,0,0); ctx.strokeStyle=color; ctx.lineWidth=size; if(tool==='rect'){ ctx.strokeRect(a.x, a.y, b.x-a.x, b.y-a.y); } else if(tool==='circle'){ const rx=(b.x-a.x)/2, ry=(b.y-a.y)/2; const cx=a.x+rx, cy=a.y+ry; const r=Math.hypot(rx,ry); ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.stroke(); } }
      let snapshot=null;
      canvas.addEventListener('mousedown', e=>{ push(); drawing=true; start=pos(e); if(tool!=='brush'){ snapshot=ctx.getImageData(0,0,canvas.width,canvas.height); } });
      canvas.addEventListener('mousemove', e=>{ if(!drawing) return; const p=pos(e); if(tool==='brush'){ line(start,p); start=p; } else { drawPreview(start,p); } });
      document.addEventListener('mouseup', e=>{ if(!drawing) return; drawing=false; const p=pos(e); if(tool==='rect'){ ctx.strokeStyle=color; ctx.lineWidth=size; ctx.strokeRect(start.x,start.y,p.x-start.x,p.y-start.y); } else if(tool==='circle'){ const rx=(p.x-start.x)/2, ry=(p.y-start.y)/2; const cx=start.x+rx, cy=start.y+ry; const r=Math.hypot(rx,ry); ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.stroke(); } });
      document.getElementById('toolBrush').addEventListener('click', ()=> tool='brush');
      document.getElementById('toolRect').addEventListener('click', ()=> tool='rect');
      document.getElementById('toolCircle').addEventListener('click', ()=> tool='circle');
      colorEl.addEventListener('input', e=> color=e.target.value); sizeEl.addEventListener('input', e=> size=Number(e.target.value));
      document.getElementById('undo').addEventListener('click', ()=>{ if(undoStack.length===0) return; const s=undoStack.pop(); redoStack.push(canvas.toDataURL()); const img=new Image(); img.onload=()=>{ ctx.clearRect(0,0,canvas.width,canvas.height); ctx.drawImage(img,0,0); }; img.src=s; });
      document.getElementById('redo').addEventListener('click', ()=>{ if(redoStack.length===0) return; const s=redoStack.pop(); undoStack.push(canvas.toDataURL()); const img=new Image(); img.onload=()=>{ ctx.clearRect(0,0,canvas.width,canvas.height); ctx.drawImage(img,0,0); }; img.src=s; });
      document.getElementById('clear').addEventListener('click', ()=>{ push(); ctx.clearRect(0,0,canvas.width,canvas.height); });
      document.getElementById('save').addEventListener('click', ()=>{ const a=document.createElement('a'); a.download='paint.png'; a.href=canvas.toDataURL('image/png'); a.click(); });
    })();
  </script>
</body>
</html>
